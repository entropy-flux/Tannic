<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tannic: Usage</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tannic
   </div>
   <div id="projectbrief">A C++ Tensor Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d0/da1/md_docs_Usage.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Usage </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To use Tannic, simply include it in your project and interact with it similarly to a Python framework:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;tannic.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d0/d1a/namespacetannic.html">tannic</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() { </div>
<div class="line">    <a class="code hl_class" href="../../da/d93/classtannic_1_1Tensor.html">Tensor</a> X(float32, {2,2}); <span class="comment">// and X.initialize(Device()) for CUDA support</span></div>
<div class="line">    </div>
<div class="line">    X[0, <a class="code hl_struct" href="../../de/dea/structtannic_1_1indexing_1_1Range.html">range</a>{0,-1}] = 1;  </div>
<div class="line">    X[1,0] = 3;             </div>
<div class="line">    X[1,1] = 4;           </div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="../../da/d93/classtannic_1_1Tensor.html">Tensor</a> Y(float64, {1,2}); </div>
<div class="line">    Y[0,0] = 4;                            </div>
<div class="line">    Y[0,1] = 6;    </div>
<div class="line">    </div>
<div class="line">    Y = <a class="code hl_function" href="../../dd/d74/namespacetannic_1_1function.html#a9ec44a47e78a5e28b75b76573d98e06b">log</a>(X) + Y * Y - <a class="code hl_function" href="../../dd/d74/namespacetannic_1_1function.html#a1a8e818c37a5236e4481677e70ce6209">exp</a>(X) + <a class="code hl_function" href="../../d0/d1a/namespacetannic.html#a3681656aa208b88dfc79a1806cf669b6">matmul</a>(X, Y.transpose()); <span class="comment">// assign expressions dynamically like in python</span></div>
<div class="line">    std::cout &lt;&lt; Y;</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="../../da/d93/classtannic_1_1Tensor.html">Tensor</a> Z = {</div>
<div class="line">        {1,2,3,4},</div>
<div class="line">        {2,3,4,5}</div>
<div class="line">    };                      <span class="comment">// int tensor</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../da/d93/classtannic_1_1Tensor.html">Tensor</a> W = {</div>
<div class="line">        {1.0f, 2.0f, 3.0f},</div>
<div class="line">        {1.0f, 2.0f, 3.0f}</div>
<div class="line">    };                      <span class="comment">// float tensor</span></div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <a class="code hl_function" href="../../d9/dd9/namespacetannic_1_1expression.html#a83caa2ee55fd9f434b633d9eba583b61">argmax</a>(Z) &lt;&lt; std::endl&gt;&gt;</div>
<div class="line">}</div>
<div class="ttc" id="aclasstannic_1_1Tensor_html"><div class="ttname"><a href="../../da/d93/classtannic_1_1Tensor.html">tannic::Tensor</a></div><div class="ttdoc">A multidimensional, strided tensor data structure.</div><div class="ttdef"><b>Definition:</b> Tensor.hpp:105</div></div>
<div class="ttc" id="anamespacetannic_1_1expression_html_a83caa2ee55fd9f434b633d9eba583b61"><div class="ttname"><a href="../../d9/dd9/namespacetannic_1_1expression.html#a83caa2ee55fd9f434b633d9eba583b61">tannic::expression::argmax</a></div><div class="ttdeci">constexpr auto argmax(Source &amp;&amp;source, int axis=-1, bool keepdim=false)</div><div class="ttdoc">Creates an Argmax reduction.</div><div class="ttdef"><b>Definition:</b> Reductions.hpp:303</div></div>
<div class="ttc" id="anamespacetannic_1_1function_html_a1a8e818c37a5236e4481677e70ce6209"><div class="ttname"><a href="../../dd/d74/namespacetannic_1_1function.html#a1a8e818c37a5236e4481677e70ce6209">tannic::function::exp</a></div><div class="ttdeci">constexpr auto exp(Operand &amp;&amp;operand)</div><div class="ttdoc">Creates a lazy-evaluated exponential function expression.</div><div class="ttdef"><b>Definition:</b> Functions.hpp:249</div></div>
<div class="ttc" id="anamespacetannic_1_1function_html_a9ec44a47e78a5e28b75b76573d98e06b"><div class="ttname"><a href="../../dd/d74/namespacetannic_1_1function.html#a9ec44a47e78a5e28b75b76573d98e06b">tannic::function::log</a></div><div class="ttdeci">constexpr auto log(Operand &amp;&amp;operand)</div><div class="ttdoc">Creates a lazy-evaluated natural logarithm expression.</div><div class="ttdef"><b>Definition:</b> Functions.hpp:237</div></div>
<div class="ttc" id="anamespacetannic_html"><div class="ttname"><a href="../../d0/d1a/namespacetannic.html">tannic</a></div><div class="ttdef"><b>Definition:</b> Buffer.hpp:43</div></div>
<div class="ttc" id="anamespacetannic_html_a3681656aa208b88dfc79a1806cf669b6"><div class="ttname"><a href="../../d0/d1a/namespacetannic.html#a3681656aa208b88dfc79a1806cf669b6">tannic::matmul</a></div><div class="ttdeci">constexpr auto matmul(Multiplicand &amp;&amp;multiplicand, Multiplier &amp;&amp;multiplier)</div><div class="ttdoc">Matrix multiplication convenience function.</div><div class="ttdef"><b>Definition:</b> Transformations.hpp:507</div></div>
<div class="ttc" id="astructtannic_1_1indexing_1_1Range_html"><div class="ttname"><a href="../../de/dea/structtannic_1_1indexing_1_1Range.html">tannic::indexing::Range</a></div><div class="ttdoc">Represents a half-open interval [start, stop) for slicing.</div><div class="ttdef"><b>Definition:</b> Indexing.hpp:56</div></div>
</div><!-- fragment --><p>Functions in Tannic do not immediately compute results. Instead, they build Expression objects, described in detail in the <a href="https://entropy-flux.github.io/Tannic/concepts.html">concepts</a> documentation. Basically an <code>Expression</code> is any class that follows the pattern:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keyword">concept </span>Expression = <span class="keyword">requires</span>(<span class="keyword">const</span> T expression) {</div>
<div class="line">    { expression.dtype()   } -&gt; std::same_as&lt;type&gt;;</div>
<div class="line">    { expression.shape()   } -&gt; std::same_as&lt;Shape const&amp;&gt;;</div>
<div class="line">    { expression.strides() } -&gt; std::same_as&lt;Strides const&amp;&gt;;</div>
<div class="line">      expression.offset();  <span class="comment">// convertible to ptrdifft_t</span></div>
<div class="line">      expression.forward(); <span class="comment">// same as Tensor or Tensor const&amp;</span></div>
<div class="line">}; </div>
</div><!-- fragment --><p>Any class that follows that pattern is a valid Tannic expression and can interact with other components of the library. All available expressions are detailed under the <a href="https://entropy-flux.github.io/Tannic/annotated.html">class list</a> section. You can scroll to the members of each expression and find information about how dtypes are promoted, or how shapes are calculated.</p>
<p>The library is built around the Host-Device computational model, so in order to use CUDA you just have to initialize kernels tensors on the Device you want to use, for example:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main() { </div>
<div class="line">    <a class="code hl_class" href="../../da/d93/classtannic_1_1Tensor.html">Tensor</a> X(float32, {2,2}); X.<a class="code hl_function" href="../../da/d93/classtannic_1_1Tensor.html#a4ee063da4965ea868081841b3d967882">initialize</a>(<a class="code hl_class" href="../../d3/d46/classtannic_1_1Device.html">Device</a>());</div>
<div class="line">    X[0, <a class="code hl_struct" href="../../de/dea/structtannic_1_1indexing_1_1Range.html">range</a>{0,-1}] = 1;   <span class="comment">// assignment just works the same on device</span></div>
<div class="line">    X[1,0] = 3;             </div>
<div class="line">    X[1,1] = 4;           </div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../da/d93/classtannic_1_1Tensor.html">Tensor</a> Y(float32, {1,2}); Y.<a class="code hl_function" href="../../da/d93/classtannic_1_1Tensor.html#a4ee063da4965ea868081841b3d967882">initialize</a>(<a class="code hl_class" href="../../d3/d46/classtannic_1_1Device.html">Device</a>());</div>
<div class="line">    ...</div>
<div class="line"> </div>
<div class="line">    Y = <a class="code hl_function" href="../../dd/d74/namespacetannic_1_1function.html#a9ec44a47e78a5e28b75b76573d98e06b">log</a>(X) + Y * Y - <a class="code hl_function" href="../../dd/d74/namespacetannic_1_1function.html#a1a8e818c37a5236e4481677e70ce6209">exp</a>(X) + <a class="code hl_function" href="../../d0/d1a/namespacetannic.html#a3681656aa208b88dfc79a1806cf669b6">matmul</a>(X, Y.transpose()); <span class="comment">// assign expressions dynamically like in python</span></div>
<div class="line">    <span class="comment">// Y is now calculated using CUDA.</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="aclasstannic_1_1Device_html"><div class="ttname"><a href="../../d3/d46/classtannic_1_1Device.html">tannic::Device</a></div><div class="ttdoc">Device memory domain.</div><div class="ttdef"><b>Definition:</b> Resources.hpp:156</div></div>
<div class="ttc" id="aclasstannic_1_1Tensor_html_a4ee063da4965ea868081841b3d967882"><div class="ttname"><a href="../../da/d93/classtannic_1_1Tensor.html#a4ee063da4965ea868081841b3d967882">tannic::Tensor::initialize</a></div><div class="ttdeci">void initialize(Allocator allocator=Host{}) const</div><div class="ttdoc">Allocates the memory buffer for the tensor.</div></div>
</div><!-- fragment --><p>The library currently lacks of some easily implementable CUDA features like copying a tensor from Host to Device and viceversa or printing CUDA tensors, I will add them soon. <br  />
</p>
<p>Data types are dynamic to make it easier to serialize and deserialize tensors at runtime, and deliver machine learning models that can work with arbitrary data types. They are represented using a C enum to be compatible with the C api runtime on wich the library relies on.</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> type { </div>
<div class="line">    none,</div>
<div class="line">    int8,</div>
<div class="line">    int16,</div>
<div class="line">    int32,</div>
<div class="line">    int64,</div>
<div class="line">    float32,</div>
<div class="line">    float64,</div>
<div class="line">    complex64,   </div>
<div class="line">    complex128,  </div>
<div class="line">    TYPES</div>
<div class="line">};</div>
</div><!-- fragment --><p>This design also paves the way for future features such as tensor quantization. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
