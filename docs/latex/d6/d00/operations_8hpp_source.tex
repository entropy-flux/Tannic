\doxysection{operations.\+hpp}
\hypertarget{operations_8hpp_source}{}\label{operations_8hpp_source}\index{include/tannic/operations.hpp@{include/tannic/operations.hpp}}
\mbox{\hyperlink{operations_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2025\ Eric\ Hermosis}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Licensed\ under\ the\ Apache\ License,\ Version\ 2.0\ (the\ "{}License"{});}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ you\ may\ not\ use\ this\ file\ except\ in\ compliance\ with\ the\ License.}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ \ \ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ distributed\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ See\ the\ License\ for\ the\ specific\ language\ governing\ permissions\ and}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ limitations\ under\ the\ License.}}
\DoxyCodeLine{00014\ \textcolor{comment}{//}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#ifndef\ OPERATIONS\_HPP}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#define\ OPERATIONS\_HPP}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ <utility>}\ \ \ \ \ \ }
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ <type\_traits>}\ }
\DoxyCodeLine{00041\ \ }
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{concepts_8hpp}{concepts.hpp}}"{}}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{expressions_8hpp}{expressions.hpp}}"{}}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{types_8hpp}{types.hpp}}"{}}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{shape_8hpp}{shape.hpp}}"{}}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{strides_8hpp}{strides.hpp}}"{}}\ \ \ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{traits_8hpp}{traits.hpp}}"{}}}
\DoxyCodeLine{00048\ \ }
\DoxyCodeLine{00049\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetannic}{tannic}}\ \{}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{class\ }Tensor;\ \ \ \ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \}\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetannic_1_1expression}{tannic::expression}}\ \{\ \ }
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00064\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ Operation,\ Composable\ Operand>}
\DoxyCodeLine{00065\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtannic_1_1expression_1_1Unary}{Unary}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{concepttannic_1_1Expression}{Expression}}<Operation,\ Operand>\ \{\ }
\DoxyCodeLine{00066\ \textcolor{keyword}{public}:\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Unary_a9893391af811a4fa38d1dca12b49640c}{Unary}}(\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{Operation}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a85272ddff07cdd719224aaacd9a4589a}{operation}},\ \mbox{\hyperlink{structtannic_1_1Trait_a9129038f382bd1ddae5bc8d9d4c255d5}{Trait<Operand>::Reference}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{operand}})}
\DoxyCodeLine{00068\ \ \ \ \ :\ \ \ \mbox{\hyperlink{concepttannic_1_1Expression}{Expression}}<\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{Operation}},\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{Operand}}>(\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a85272ddff07cdd719224aaacd9a4589a}{operation}},\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{operand}})}
\DoxyCodeLine{00069\ \ \ \ \ \{\}\ \ }
\DoxyCodeLine{00070\ \ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{type}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Unary_a4edd1787286c9ae3cd14b5ed82fa2211}{dtype}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::get<0>(this-\/>\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a9cd4a5da73e546d8eaf2a31041df758a}{operands}}).\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison_a2cd31d96cb96ce4cb785e7d36343b8ea}{dtype}}();}
\DoxyCodeLine{00073\ \ \ \ \ \}\ }
\DoxyCodeLine{00074\ \ \ \ \ }
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{classtannic_1_1expression_1_1Unary_a63051a1591b037983de89f0153118317}{shape}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::get<0>(this-\/>\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a9cd4a5da73e546d8eaf2a31041df758a}{operands}}).\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison_a7d7526a84f620fa1ee0b73a51ce2137f}{shape}}();}
\DoxyCodeLine{00077\ \ \ \ \ \}\ }
\DoxyCodeLine{00078\ \ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Strides}{Strides}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{classtannic_1_1expression_1_1Unary_ad9daaa825a3fcc17d83b1485cb49057d}{strides}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::get<0>(this-\/>\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a9cd4a5da73e546d8eaf2a31041df758a}{operands}}).\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison_a0bb211f808eb0d002a079df08e7e305d}{strides}}();}
\DoxyCodeLine{00081\ \ \ \ \ \}\ \ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ std::ptrdiff\_t\ \mbox{\hyperlink{classtannic_1_1expression_1_1Unary_a4e0c64cba6ef2ba3ee8485baa2667896}{offset}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::get<0>(this-\/>\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a9cd4a5da73e546d8eaf2a31041df758a}{operands}}).offset();}
\DoxyCodeLine{00085\ \ \ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Unary_a8e353e45bb09a8c5f02323afd88c14f2}{forward}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00088\ \};}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00101\ \textcolor{keyword}{template}<Operator\ Operation,\ Composable\ Operand,\ Composable\ Cooperand>}
\DoxyCodeLine{00102\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtannic_1_1expression_1_1Binary}{Binary}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{concepttannic_1_1Expression}{Expression}}<Operation,\ Operand,\ Cooperand>\ \{}
\DoxyCodeLine{00103\ \textcolor{keyword}{public}:\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Binary_a8fa9c1fe8f6cf694a58642f13196f795}{Binary}}(\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{Operation}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a85272ddff07cdd719224aaacd9a4589a}{operation}},\ \mbox{\hyperlink{structtannic_1_1Trait_a9129038f382bd1ddae5bc8d9d4c255d5}{Trait<Operand>::Reference}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{operand}},\ \mbox{\hyperlink{structtannic_1_1Trait_a9129038f382bd1ddae5bc8d9d4c255d5}{Trait<Cooperand>::Reference}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{cooperand}})}
\DoxyCodeLine{00105\ \ \ \ \ :\ \ \ \mbox{\hyperlink{concepttannic_1_1Expression}{Expression}}<\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{Operation}},\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{Operand}},\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{Cooperand}}>(\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a85272ddff07cdd719224aaacd9a4589a}{operation}},\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{operand}},\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{cooperand}})}
\DoxyCodeLine{00106\ \ \ \ \ ,\ \ \ dtype\_(\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a85272ddff07cdd719224aaacd9a4589a}{operation}}.promote(\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{operand}}.\mbox{\hyperlink{classtannic_1_1expression_1_1Binary_ab5c976ef9f8c2d18320b8489b831b141}{dtype}}(),\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{cooperand}}.\mbox{\hyperlink{classtannic_1_1expression_1_1Binary_ab5c976ef9f8c2d18320b8489b831b141}{dtype}}()))}
\DoxyCodeLine{00107\ \ \ \ \ ,\ \ \ shape\_(\mbox{\hyperlink{classtannic_1_1expression_1_1Expression_a85272ddff07cdd719224aaacd9a4589a}{operation}}.broadcast(\mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{operand}}.\mbox{\hyperlink{classtannic_1_1expression_1_1Binary_ae914aa31be0834ee7a18218f39243cfc}{shape}}(),\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{cooperand}}.\mbox{\hyperlink{classtannic_1_1expression_1_1Binary_ae914aa31be0834ee7a18218f39243cfc}{shape}}()))}
\DoxyCodeLine{00108\ \ \ \ \ ,\ \ \ strides\_(shape\_)}
\DoxyCodeLine{00109\ \ \ \ \ \{\}\ }
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{type}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Binary_ab5c976ef9f8c2d18320b8489b831b141}{dtype}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dtype\_;}
\DoxyCodeLine{00113\ \ \ \ \ \}\ }
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{classtannic_1_1expression_1_1Binary_ae914aa31be0834ee7a18218f39243cfc}{shape}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ shape\_;}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ \ \ \ \ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Strides}{Strides}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{classtannic_1_1expression_1_1Binary_a4b9925ea17dbf66aae8ce53bb2322f64}{strides}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ strides\_;}
\DoxyCodeLine{00121\ \ \ \ \ \}\ }
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ std::ptrdiff\_t\ \mbox{\hyperlink{classtannic_1_1expression_1_1Binary_ad538b474e963268753595c5d04c8f108}{offset}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00125\ \ \ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \mbox{\hyperlink{classtannic_1_1expression_1_1Binary_a25f79a1644fbe89f707d28578dfb97b0}{forward}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00130\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1expression_1_1Comparison}{type}}\ dtype\_;}
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ shape\_;}
\DoxyCodeLine{00132\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Strides}{Strides}}\ strides\_;}
\DoxyCodeLine{00133\ \};\ \ \ \ \ }
\DoxyCodeLine{00134\ \ \ }
\DoxyCodeLine{00135\ \}\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetannic_1_1operation}{tannic::operation}}\ \{}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtannic_1_1expression_1_1Unary}{tannic::expression::Unary}};}
\DoxyCodeLine{00138\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classtannic_1_1expression_1_1Binary}{tannic::expression::Binary}};}
\DoxyCodeLine{00139\ \ \ \ \ }
\DoxyCodeLine{00151\ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{inline}\ type\ promote(type\ first,\ type\ second)\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(first)\ >\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(second)\ ?\ \ first\ :\ second;}
\DoxyCodeLine{00153\ \}\ }
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00176\ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ Shape\ broadcast(Shape\ \textcolor{keyword}{const}\&\ first,\ Shape\ \textcolor{keyword}{const}\&\ second)\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keyword}{auto}\ first\_rank\ =\ first.\mbox{\hyperlink{classtannic_1_1Shape_a35f7ff956c2e5dcb77b0165bb4e21522}{rank}}();}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keyword}{auto}\ second\_rank\ =\ second.rank();}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keyword}{auto}\ rank\ =\ std::max(first\_rank,\ second\_rank);}
\DoxyCodeLine{00180\ \ \ \ \ Shape\ shape;\ \ }
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ dimension\ =\ 0;\ dimension\ <\ rank;\ ++dimension)\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ first\_dimension\ =\ (dimension\ <\ rank\ -\/\ first\_rank)\ ?\ 1\ :\ first[dimension\ -\/\ (rank\ -\/\ first\_rank)];}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ second\_dimension\ =\ (dimension\ <\ rank\ -\/\ second\_rank)\ ?\ 1\ :\ second[dimension\ -\/\ (rank\ -\/\ second\_rank)];}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(first\_dimension\ ==\ second\_dimension\ ||\ first\_dimension\ ==\ 1\ ||\ second\_dimension\ ==\ 1))\ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ Exception(\textcolor{stringliteral}{"{}Shapes\ are\ not\ broadcast-\/compatible."{}});}
\DoxyCodeLine{00187\ \ \ \ \ \}}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ shape.expand(std::max(first\_dimension,\ second\_dimension));}
\DoxyCodeLine{00189\ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordflow}{return}\ shape;}
\DoxyCodeLine{00191\ \}\ }
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00217\ \textcolor{keyword}{struct\ }Negation\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordtype}{void}\ forward(Tensor\ \textcolor{keyword}{const}\&,\ Tensor\&)\ \textcolor{keyword}{const};\ \ \ }
\DoxyCodeLine{00219\ \};}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00245\ \textcolor{keyword}{struct\ }Addition\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keywordtype}{void}\ forward(Tensor\ \textcolor{keyword}{const}\&,\ Tensor\ \textcolor{keyword}{const}\&,\ Tensor\&)\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ type\ promote(type\ first,\ type\ second)\ \{}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::promote(first,\ second);}
\DoxyCodeLine{00250\ \ \ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ Shape\ broadcast(Shape\ \textcolor{keyword}{const}\&\ first,\ Shape\ \textcolor{keyword}{const}\&\ second)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::broadcast(first,\ second);}
\DoxyCodeLine{00254\ \ \ \ \ \}}
\DoxyCodeLine{00255\ \};}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00281\ \textcolor{keyword}{struct\ }Multiplication\ \{}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordtype}{void}\ forward(Tensor\ \textcolor{keyword}{const}\&,\ Tensor\ \textcolor{keyword}{const}\&,\ Tensor\&)\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ type\ promote(type\ first,\ type\ second)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::promote(first,\ second);}
\DoxyCodeLine{00286\ \ \ \ \ \}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ Shape\ broadcast(Shape\ \textcolor{keyword}{const}\&\ first,\ Shape\ \textcolor{keyword}{const}\&\ second)\ \{}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::broadcast(first,\ second);}
\DoxyCodeLine{00290\ \ \ \ \ \}}
\DoxyCodeLine{00291\ \};}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00317\ \textcolor{keyword}{struct\ }Subtraction\ \{}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keywordtype}{void}\ forward(Tensor\ \textcolor{keyword}{const}\&,\ Tensor\ \textcolor{keyword}{const}\&,\ Tensor\&)\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ type\ promote(type\ first,\ type\ second)\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::promote(first,\ second);}
\DoxyCodeLine{00322\ \ \ \ \ \}}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ Shape\ broadcast(Shape\ \textcolor{keyword}{const}\&\ first,\ Shape\ \textcolor{keyword}{const}\&\ second)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::broadcast(first,\ second);}
\DoxyCodeLine{00326\ \ \ \ \ \}}
\DoxyCodeLine{00327\ \};\ }
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00355\ \textcolor{keyword}{struct\ }Exponentiation\ \{}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordtype}{void}\ forward(Tensor\ \textcolor{keyword}{const}\&,\ Tensor\ \textcolor{keyword}{const}\&,\ Tensor\&)\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ type\ promote(type\ first,\ type\ second)\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::promote(first,\ second);}
\DoxyCodeLine{00360\ \ \ \ \ \}}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ Shape\ broadcast(Shape\ \textcolor{keyword}{const}\&\ first,\ Shape\ \textcolor{keyword}{const}\&\ second)\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ operation::broadcast(first,\ second);}
\DoxyCodeLine{00364\ \ \ \ \ \}}
\DoxyCodeLine{00365\ \};}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00378\ \textcolor{keyword}{template}<Composable\ Operand>}
\DoxyCodeLine{00379\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ operator-\/(Operand\&\&\ operand)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ \textcolor{keywordflow}{return}\ Unary<Negation,\ Operand>\{\{\},\ std::forward<Operand>(operand)\};}
\DoxyCodeLine{00381\ \}\ \ }
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00399\ \textcolor{keyword}{template}<Composable\ Augend,\ Composable\ Addend>}
\DoxyCodeLine{00400\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ operator+(Augend\&\&\ augend,\ Addend\&\&\ addend)\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keywordflow}{return}\ Binary<Addition,\ Augend,\ Addend>\{\{\},\ std::forward<Augend>(augend),\ std::forward<Addend>(addend)\};}
\DoxyCodeLine{00402\ \}}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00420\ \textcolor{keyword}{template}<Composable\ Subtrahend,\ Composable\ Minuend>}
\DoxyCodeLine{00421\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ operator-\/(Subtrahend\&\&\ subtrahend,\ Minuend\&\&\ minuend)\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordflow}{return}\ Binary<Subtraction,\ Subtrahend,\ Minuend>\{\{\},\ std::forward<Subtrahend>(subtrahend),\ std::forward<Minuend>(minuend)\};}
\DoxyCodeLine{00423\ \}}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00441\ \textcolor{keyword}{template}<Composable\ Multiplicand,\ Composable\ Multiplier>}
\DoxyCodeLine{00442\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ operator*(Multiplicand\&\&\ multiplicand,\ Multiplier\&\&\ multiplier)\ \{}
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{keywordflow}{return}\ Binary<Multiplication,\ Multiplicand,\ Multiplier>\{\{\},\ std::forward<Multiplicand>(multiplicand),\ std::forward<Multiplier>(multiplier)\};}
\DoxyCodeLine{00444\ \}\ \ }
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00465\ \textcolor{keyword}{template}<Composable\ Base,\ Composable\ Exponent>}
\DoxyCodeLine{00466\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ operator\string^(Base\&\&\ base,\ Exponent\&\&\ exponent)\ \{}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keywordflow}{return}\ Binary<Exponentiation,\ Base,\ Exponent>\{\{\},\ std::forward<Base>(base),\ std::forward<Exponent>(exponent)\};}
\DoxyCodeLine{00468\ \}\ }
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \}\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetannic}{tannic}}\ \{}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \textcolor{keyword}{using\ }operation::operator-\/;\ }
\DoxyCodeLine{00473\ \textcolor{keyword}{using\ }operation::operator+;\ }
\DoxyCodeLine{00474\ \textcolor{keyword}{using\ }operation::operator*;\ \ }
\DoxyCodeLine{00475\ \textcolor{keyword}{using\ }operation::operator\string^;\ \ \ }
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \}\ \textcolor{comment}{//\ namespace\ tannic}}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ OPERATIONS\_HPP\ }}

\end{DoxyCode}
