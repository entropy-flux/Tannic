\doxysection{Transformations.\+hpp}
\hypertarget{Transformations_8hpp_source}{}\label{Transformations_8hpp_source}\index{include/tannic/Transformations.hpp@{include/tannic/Transformations.hpp}}
\mbox{\hyperlink{Transformations_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2025\ Eric\ Hermosis}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Licensed\ under\ the\ Apache\ License,\ Version\ 2.0\ (the\ "{}License"{});}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ you\ may\ not\ use\ this\ file\ except\ in\ compliance\ with\ the\ License.}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ \ \ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ distributed\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ See\ the\ License\ for\ the\ specific\ language\ governing\ permissions\ and}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ limitations\ under\ the\ License.}}
\DoxyCodeLine{00014\ \textcolor{comment}{//}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#ifndef\ TRANSFORMATIONS\_HPP}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#define\ TRANSFORMATIONS\_HPP\ }}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ <tuple>}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Concepts_8hpp}{Concepts.hpp}}"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Types_8hpp}{Types.hpp}}"{}}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Traits_8hpp}{Traits.hpp}}"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Shape_8hpp}{Shape.hpp}}"{}}\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Tensor_8hpp}{Tensor.hpp}}"{}}\ }
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Exceptions_8hpp}{Exceptions.hpp}}"{}}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacetannic}{tannic}}\ \{}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{class\ }Tensor;\ \ }
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{keyword}{namespace\ }transformation\ \{}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{template}<\textcolor{keyword}{class\ }Operation,\ \mbox{\hyperlink{concepttannic_1_1Expression}{Expression}}\ ...\ Operands>}
\DoxyCodeLine{00058\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation}{Transformation}}\ \{}
\DoxyCodeLine{00059\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00060\ \ \ \ \ Operation\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a09f348f1360ddb16babeb5c36986ce7f}{operation}};}
\DoxyCodeLine{00061\ \ \ \ \ std::tuple<typename\ Trait<Operands>::Reference...>\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a8c594c8947003e7ef016e8d4e6003a49}{operands}};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a9204f338e3bdfd0d018e77b363e73d18}{Transformation}}(Operation\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a09f348f1360ddb16babeb5c36986ce7f}{operation}},\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structtannic_1_1Trait_a9129038f382bd1ddae5bc8d9d4c255d5}{Trait<Operands>::Reference}}...\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a8c594c8947003e7ef016e8d4e6003a49}{operands}})}
\DoxyCodeLine{00069\ \ \ \ \ :\ \ \ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a09f348f1360ddb16babeb5c36986ce7f}{operation}}(\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a09f348f1360ddb16babeb5c36986ce7f}{operation}})}
\DoxyCodeLine{00070\ \ \ \ \ ,\ \ \ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a8c594c8947003e7ef016e8d4e6003a49}{operands}}(\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a8c594c8947003e7ef016e8d4e6003a49}{operands}}...)\ }
\DoxyCodeLine{00071\ \ \ \ \ ,\ \ \ dtype\_(\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a09f348f1360ddb16babeb5c36986ce7f}{operation}}.promote(\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a8c594c8947003e7ef016e8d4e6003a49}{operands}}.\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a2bcf28b6dd2d820780960d645d9559d6}{dtype}}()...))}
\DoxyCodeLine{00072\ \ \ \ \ ,\ \ \ shape\_(\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a09f348f1360ddb16babeb5c36986ce7f}{operation}}.transform(\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a8c594c8947003e7ef016e8d4e6003a49}{operands}}.\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_af98b88d10c88e966c6f3d25a2498939a}{shape}}()...))\ }
\DoxyCodeLine{00073\ \ \ \ \ ,\ \ \ strides\_(shape\_)}
\DoxyCodeLine{00074\ \ \ \ \ \{\}}
\DoxyCodeLine{00075\ \ \ \ \ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{type}}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a2bcf28b6dd2d820780960d645d9559d6}{dtype}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dtype\_;}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_af98b88d10c88e966c6f3d25a2498939a}{shape}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ shape\_;}
\DoxyCodeLine{00090\ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Strides}{Strides}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a34ff066350d57fd9f759b2395b949d40}{strides}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ strides\_;}
\DoxyCodeLine{00098\ \ \ \ \ \}\ }
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00104\ \ \ \ \ std::ptrdiff\_t\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_ad473aa1af5b9d6c44ffab2b42baa7566}{offset}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00106\ \ \ \ \ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{forward}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{result}}(dtype\_,\ shape\_);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ std::apply([\&](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&...\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{arguments}})\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a09f348f1360ddb16babeb5c36986ce7f}{operation}}.forward(\mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{arguments}}.\mbox{\hyperlink{classtannic_1_1Tensor_a24efaf36c2ec793288c470e5e92ad397}{forward}}()...,\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{result}});}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \},\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_a8c594c8947003e7ef016e8d4e6003a49}{operands}});}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{result}};}
\DoxyCodeLine{00118\ \ \ \ \ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00121\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation_aa7ce3925268c4b20658c6c9c926d8fab}{type}}\ dtype\_;}
\DoxyCodeLine{00122\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ shape\_;\ }
\DoxyCodeLine{00123\ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Strides}{Strides}}\ strides\_;}
\DoxyCodeLine{00124\ \};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00132\ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ index(type\ first,\ type\ second)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(first)\ +\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(second)\ *\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(TYPES);}
\DoxyCodeLine{00134\ \}\ \ }
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00144\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition}{Composition}}\ \{\ \ \ \ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_ae5532fbe7069dd08c4ee780f4b4e6a51}{promotions}}\ =\ []()\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ std::array<\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{type}},\ index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{TYPES}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{TYPES}})>\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}\{\};\ \ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}.fill(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{none}});}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Integer\ promotions}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}})]\ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}})]\ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}})]\ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};\ \ }
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}})]\ \ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}})]\ \ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}};}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};\ }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int8}})]\ \ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int16}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}})]\ \ \ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int64}};\ }
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Mixed\ integer/float\ promotions}}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}};}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}};}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}};}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{int32}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}};\ }
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Float\ promotions}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}};}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}};}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float32}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}};}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}})]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{float64}};\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{table}};}
\DoxyCodeLine{00189\ \ \ \ \ \}();\ \ }
\DoxyCodeLine{00190\ \ }
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a9eb38435828870a1ad2c1eadddea0c82}{promote}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{inner}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{type}}\ outer)\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{type}}\ dtype\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_ae5532fbe7069dd08c4ee780f4b4e6a51}{promotions}}[index(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{inner}},\ \mbox{\hyperlink{namespacetannic_1_1transformation_aae536af65f2dee7cb7279c58f82b2e2d}{outer}})];}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dtype\ ==\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{none}})\ }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}Unsuported\ dtypes"{}});}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dtype;}
\DoxyCodeLine{00219\ \ \ \ \ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a8e816b4edf365755d931b95a420a6269}{transform}}(\mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}},\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}})\ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_rank}}\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}.\mbox{\hyperlink{classtannic_1_1Shape_a35f7ff956c2e5dcb77b0165bb4e21522}{rank}}();}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_rank}}\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}.rank();}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_rank}}\ ==\ 1\ \&\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_rank}}\ ==\ 1)\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_rank}}\ !=\ 1\ |\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_rank}}\ !=\ 1)}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}dimensions\ must\ match\ for\ dot\ product"{}});}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\{\};\ \ \textcolor{comment}{//\ Scalar\ result}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_rank}}\ ==\ 1\ \&\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_rank}}\ ==\ 2)\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}[0]\ !=\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}[0])}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}Matrix\ inner\ dimensions\ do\ not\ match"{}});}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}[0]\ !=\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}[0])}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\{\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}[0]\};\ \ \textcolor{comment}{//\ Vector\ result}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Vector-\/matrix\ multiplication}}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_rank}}\ ==\ 2\ \&\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_rank}}\ ==\ 1)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}[1]\ !=\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}[0])}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}Matrix\ inner\ dimensions\ do\ not\ match"{}});}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\{\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}[0]\};\ \ \textcolor{comment}{//\ Vector\ result}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \}\ \ }
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_rank}}\ <\ 2\ |\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_rank}}\ <\ 2)\ }
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}Inputs\ must\ have\ rank\ >=\ 2"{}});}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Handle\ batch\ dimensions}}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_batches}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}.begin(),\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}.end()\ -\/\ 2);}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_batches}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}.begin(),\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}.end()\ -\/\ 2);}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{batches}}\ =\ operation::broadcast(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first\_batches}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second\_batches}});}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ matrix\ inner\ dimensions}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{K1}}\ =\ *(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}.end()\ -\/\ 1);}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{K2}}\ =\ *(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}.end()\ -\/\ 2);\ \ \ }
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{assert}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{K1}}\ ==\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{K2}}\ \&\&\ \textcolor{stringliteral}{"{}Inner\ dimensions\ must\ match\ for\ matmul"{}});}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ output\ matrix\ dimensions}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{M}}\ =\ *(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{first}}.end()\ -\/\ 2);}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{N}}\ =\ *(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{second}}.end()\ -\/\ 1);}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Combine\ batch\ and\ matrix\ dimensions}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ std::vector<Shape::size\_type>\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{result}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{batches}}.begin(),\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{batches}}.end());}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{result}}.push\_back(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{M}});}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{result}}.push\_back(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{N}});}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{result}});}
\DoxyCodeLine{00281\ \ \ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{forward}}(\mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \textcolor{keyword}{const}\&\ outer,\ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{inner}},\ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Composition_a5a1e66b56b18be4cfcd4d69b7a9a1bf0}{result}})\ \textcolor{keyword}{const};\ }
\DoxyCodeLine{00284\ \};\ }
\DoxyCodeLine{00285\ \ }
\DoxyCodeLine{00293\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtannic_1_1transformation_1_1Outer}{Outer}}\ \{\ }
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a687581d53adbde67776d822973d82140}{promote}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{first}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{second}})\ \{}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{first}})\ >\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{second}})\ ?\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{first}}\ :\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{second}};}
\DoxyCodeLine{00304\ \ \ \ \ \}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a6024db41716131b3010e98c4c8750f70}{transform}}(\mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{first}},\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{second}})\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{first}}.rank()\ !=\ 1\ |\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{second}}.rank()\ !=\ 1)\ }
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}Outer\ product\ of\ tensors\ with\ rank\ more\ than\ 1\ not\ supported"{}});}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{first}}[0],\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{second}}[0]);}
\DoxyCodeLine{00324\ \ \ \ \ \}}
\DoxyCodeLine{00325\ \ }
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{forward}}(\mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{first}},\ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{second}},\ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Outer_a860078a88144f3b347abe590d4587544}{result}})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00327\ \};\ \ }
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00334\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition}{Repetition}}\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_ad81145fd3afc10df86f8947523ed638f}{repeats}};}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_ab37be05a5f1045efebb79b80e0bf7ee0}{axis}};}
\DoxyCodeLine{00337\ \ \ \ \ \ }
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_ab498ec608a7dcfe845d1d15fe4d9cf3e}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_aeb2cf220d62b164396993fad28d9c278}{promote}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_ab498ec608a7dcfe845d1d15fe4d9cf3e}{type}}\ dtype)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dtype;}
\DoxyCodeLine{00348\ \ \ \ \ \}}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_a119132fd4a9bccd6069465129d5efb39}{transform}}(\mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ shape)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ shape[\mbox{\hyperlink{namespacetannic_1_1indexing_ace9349c1e3b97c3df8283cde013aee85}{indexing::normalize}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_ab37be05a5f1045efebb79b80e0bf7ee0}{axis}},\ shape.\mbox{\hyperlink{classtannic_1_1Shape_a35f7ff956c2e5dcb77b0165bb4e21522}{rank}}())]\ *=\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_ad81145fd3afc10df86f8947523ed638f}{repeats}};\ }
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ shape;}
\DoxyCodeLine{00361\ \ \ \ \ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Repetition_ab498ec608a7dcfe845d1d15fe4d9cf3e}{forward}}(\mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \textcolor{keyword}{const}\&,\ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\&)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00364\ \};}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00372\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation}{Concatenation}}\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a260d08404464240bead779361c2973ea}{axis}};}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a493aff346483146c21f695dcf09777cc}{promote}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}},\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{type}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{second}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}}\ !=\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{second}})}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}Cannot\ concatenate\ tensors\ of\ different\ dtypes"{}});}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}};}
\DoxyCodeLine{00387\ \ \ \ \ \}\ }
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a6441069a6bfe2b6947fe1570ba1eb6ae}{transform}}(\mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}},\ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \textcolor{keyword}{const}\&\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{second}})\ \{}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{assert}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}}.rank()\ ==\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{second}}.rank()\ \&\&\ \textcolor{stringliteral}{"{}Ranks\ must\ match\ for\ concatenation"{}});}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtannic_1_1Shape}{Shape}}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{result}}\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}};}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}\ =\ 0;\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}\ <\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}}.rank();\ ++\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}})\ \{}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}\ ==\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a260d08404464240bead779361c2973ea}{axis}})\ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{result}}[\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}]\ =\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}}[\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}]\ +\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{second}}[\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}];}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{first}}[\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}]\ !=\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{second}}[\mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{dimension}}])}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classtannic_1_1Exception}{Exception}}(\textcolor{stringliteral}{"{}All\ dimensions\ except\ concat\ axis\ must\ match"{}});}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{result}};}
\DoxyCodeLine{00413\ \ \ \ \ \}}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structtannic_1_1transformation_1_1Concatenation_a0fb69b59b92074c0debbe533ecab8d61}{forward}}(\mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \textcolor{keyword}{const}\&,\ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\ \textcolor{keyword}{const}\&,\ \mbox{\hyperlink{classtannic_1_1Tensor}{Tensor}}\&)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00416\ \};}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00427\ \textcolor{keyword}{template}<Expression\ Outer,\ Expression\ Inner>}
\DoxyCodeLine{00428\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetannic_1_1transformation_a305bc5073fd7fbb2f1948a77c5e5a969}{composition}}(\mbox{\hyperlink{structtannic_1_1transformation_1_1Outer}{Outer}}\&\&\ outer,\ Inner\&\&\ inner)\ \{}
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation}{Transformation<Composition,\ Outer,\ Inner>}}\{}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \{\},\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ std::forward<Outer>(\mbox{\hyperlink{namespacetannic_1_1transformation_aae536af65f2dee7cb7279c58f82b2e2d}{outer}}),\ }
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ std::forward<Inner>(inner)}
\DoxyCodeLine{00433\ \ \ \ \ \};}
\DoxyCodeLine{00434\ \}\ }
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00444\ \textcolor{keyword}{template}<Expression\ First,\ Expression\ Second>}
\DoxyCodeLine{00445\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetannic_1_1transformation_aae536af65f2dee7cb7279c58f82b2e2d}{outer}}(First\&\&\ first,\ Second\&\&\ second)\ \{}
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation}{Transformation<Outer,\ First,\ Second>}}(}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \{\},}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ std::forward<First>(first),}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ std::forward<Second>(second)}
\DoxyCodeLine{00450\ \ \ \ \ );}
\DoxyCodeLine{00451\ \}\ \ \ }
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00463\ \textcolor{keyword}{template}<Expression\ Source>}
\DoxyCodeLine{00464\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetannic_1_1transformation_a4f49aca0f8b48ceb6f1992c5f34ab6fb}{repeat}}(Source\&\&\ source,\ \textcolor{keywordtype}{int}\ repeats,\ \textcolor{keywordtype}{int}\ axis\ =\ 0)\ \{}
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation}{Transformation<Repetition,\ Source>}}(}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \{repeats,\ \mbox{\hyperlink{namespacetannic_1_1indexing_ace9349c1e3b97c3df8283cde013aee85}{indexing::normalize}}(axis,\ source.shape().rank())\},}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ std::forward<Source>(source)}
\DoxyCodeLine{00468\ \ \ \ \ );\ }
\DoxyCodeLine{00469\ \}}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00482\ \textcolor{keyword}{template}<Expression\ First,\ Expression\ Second>}
\DoxyCodeLine{00483\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetannic_1_1transformation_adb2680136e1491dededb15e6f6169f77}{concatenate}}(First\&\&\ first,\ Second\&\&\ second,\ \textcolor{keywordtype}{int}\ axis\ =\ 0)\ \{}
\DoxyCodeLine{00484\ \ \ \ \ assert(axis\ >=\ 0\ \&\&\ \textcolor{stringliteral}{"{}Negative\ index\ not\ supported\ in\ concat"{}});}
\DoxyCodeLine{00485\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classtannic_1_1transformation_1_1Transformation}{Transformation<Concatenation,\ First,\ Second>}}(}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \{axis\},}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ std::forward<First>(first),}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ std::forward<Second>(second)}
\DoxyCodeLine{00489\ \ \ \ \ );\ }
\DoxyCodeLine{00490\ \}}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \}\ \textcolor{comment}{//\ namespace\ transformation}}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacetannic_1_1transformation_aae536af65f2dee7cb7279c58f82b2e2d}{transformation::outer}};}
\DoxyCodeLine{00495\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacetannic_1_1transformation_a4f49aca0f8b48ceb6f1992c5f34ab6fb}{transformation::repeat}};}
\DoxyCodeLine{00496\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacetannic_1_1transformation_adb2680136e1491dededb15e6f6169f77}{transformation::concatenate}};}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00506\ \textcolor{keyword}{template}<Expression\ Multiplicand,\ Expression\ Multiplier>}
\DoxyCodeLine{00507\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespacetannic_a3681656aa208b88dfc79a1806cf669b6}{matmul}}(Multiplicand\&\&\ multiplicand,\ Multiplier\&\&\ multiplier)\ \{}
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacetannic_1_1transformation_a305bc5073fd7fbb2f1948a77c5e5a969}{transformation::composition}}(}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ std::forward<Multiplicand>(multiplicand),}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ std::forward<Multiplier>(multiplier)}
\DoxyCodeLine{00511\ \ \ \ \ );}
\DoxyCodeLine{00512\ \}}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \}\ \textcolor{comment}{//\ namespace\ tannic}}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ TRANSFORMATIONS\_HPP}}

\end{DoxyCode}
